<link rel="import" href="../../../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">


<dom-module id="log-add">
  <template>

    <firebase-auth
    id="auth"
    user="{{user}}"
    provider="google"
    on-error="handleError"
    status-known="{{statusKnown}}" >
      </firebase-auth>
      <firebase-query
        id="query"
        path="/users/[[user.uid]]"
        data="{{notes}}">
      </firebase-query>

      <template is="dom-if" if="[[user]]">

        <h1>Welcome to my app [[user.displayName]]</h1>
      </template>
      <paper-button risen on-tap="login" hidden$="[[user]]">Sing In</paper-button>
      <paper-button risen on-tap="logout" hidden$="[[!user]]">Sing Out</paper-button>


  </template>

  <script>
  Polymer({
      is:'log-add',
      properties : {
        user: {
          type: Object,
          observer: "userObserver"
        },
        statusKnown: {
          type: Object
        }
      },
      login: function() {
        return this.$.auth.signInWithPopup();
        window.add(this.user)
      },
      logout: function() {
        return this.$.auth.signOut();
      },
      userObserver: function(user){
        console.log(user)
        if(user){
          var userName= user.displayName;
          var userEmail= user.email;
          var userPhoto= user.photoURL;
          this.$.query.ref.set({
            name: userName,
            email: userEmail,
            photo: userPhoto
          });
        }
      }
    });

  </script>
</dom-module>
